/** * Created by joe on 26/10/14. */public class Convolution {    public static Image convolve(Image input, double[][] kernel){        System.out.println("Performing convolution...") ;        Image paddedImage = padBoundary(input, kernel.length, kernel[0].length);        Image convolvedImage = new Image(input.depth, input.width, input.height);        for(int y = 0; y < input.height; y++){            for(int x = 0; x< input.width; x++){                double convolvedValue = 0;                int yMin = kernel.length - (int)Math.floor(kernel.length / 2);                int xMin = kernel[0].length - (int)Math.floor(kernel[0].length/2);                for(int kY = 0; kY<kernel.length; kY++){                    for(int kX=0; kX<kernel[kY].length; kX++){//                        System.out.printf("Convolving (%s,%s) with kernel value at (%s,%s), midpoint set to (%s, %s)%n", x, y, kX, kY, xMin, yMin);                        convolvedValue += paddedImage.pixels[x + kX - xMin + kernel[0].length][y + kY - yMin + kernel.length] * kernel[kY][kX];                    }                }                convolvedImage.pixels[x][y] = (int)convolvedValue;            }            System.out.printf("%s complete%n", ((double)y)/input.height);        }        return convolvedImage;    }    private static Image padBoundary(Image input, int kernelHeight, int kernelWidth){        Image output = new Image(input.depth, input.width + kernelWidth*2, input.height+kernelHeight*2);        //Pad Sides        for(int y = 0; y < input.height; y++){            for(int i = 0; i < kernelWidth; i++){                output.pixels[i][y+kernelHeight] = input.pixels[kernelWidth-i][y];            }            for(int i = kernelWidth; i < kernelWidth*2; i++){                output.pixels[i+input.width][y+kernelHeight] = input.pixels[input.width-i+kernelWidth-1][y];            }        }        //Copy Image Reminder        for(int y = 0; y < input.height; y++){            for(int x = 0; x < input.width; x++){                output.pixels[x+kernelWidth][y+kernelHeight] = input.pixels[x][y];            }        }        //Pad Tops        for(int x = 0; x < output.width; x++){            for(int i = 0; i < kernelHeight; i++){                output.pixels[x][i] = output.pixels[x][i-1+kernelHeight];            }            for(int i = kernelHeight; i < kernelHeight*2; i++) {                output.pixels[x][input.width+i] = output.pixels[x][output.height-i-1];            }        }        output.WritePGM("padded.pgm");//        try {//            Runtime.getRuntime().exec("open padded.pgm");//        }catch(java.io.IOException e){////        }        return output;    }}